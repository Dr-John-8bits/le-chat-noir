<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Le Chat Noir — Constellation</title>
  <meta name="description" content="Expérimentation de page d’accueil pour la webradio Le Chat Noir : carte cosmique interactive des émissions." />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet" />
  <style>
    :root{
      --night-0:#000; --night-1:#05060a; --night-2:#0a0b10;
      --accent:#ff7a18; --accent-2:#ff3d00; --accent-3:#ffd761;
      --ink:#e9f1ff;
    }
    html,body{height:100%;}
    body{
      margin:0; color:var(--ink);
      background:
        radial-gradient(1200px 900px at 50% -30%, rgba(255,255,255,.04) 0%, transparent 60%),
        radial-gradient(1200px 900px at 50% 130%, rgba(255,255,255,.03) 0%, transparent 60%),
        linear-gradient(180deg, var(--night-2), var(--night-1) 40%, var(--night-0));
      overflow-x:hidden;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica Neue, Arial, Noto Sans, Liberation Sans, sans-serif;
    }

    /* Canvas starfield */
    #starfieldCanvas{ position:fixed; inset:0; width:100%; height:100%; z-index:0; display:block; }

    /* Navbar minimaliste */
    .navbar-custom{ background: rgba(6,9,20,.45); border-bottom:1px solid rgba(255,255,255,.06); }

    main{ position:relative; z-index:2; }

    /* HERO */
    .hero{ padding:10vh 0 6vh; text-align:center; }
    .hero h1{ font-weight:800; letter-spacing:.5px; }
    .spectrum{ height:14px; margin:18px auto 0; max-width:880px; opacity:.85;
      background: repeating-linear-gradient(90deg, transparent 0 6px, rgba(255,255,255,.06) 6px 7px),
                  linear-gradient(90deg, var(--accent), var(--accent-2) 50%, var(--accent-3));
      border-radius:6px; filter: blur(.3px); }
    .hero p{ max-width:760px; margin:14px auto 0; color:#cbd7fb; }

    /* SECTION CONSTELLATION */
    .constellation-wrap{ position:relative; max-width:1100px; margin: 2rem auto 3rem; padding: 0 1rem; }
    svg.constellation{ width:100%; height:auto; aspect-ratio: 16/9; display:block; }
    .star-link{ cursor:pointer; }
    .node{ fill:#111; stroke:#9ecbff; stroke-width:2; }
    .node:hover{ filter: drop-shadow(0 0 6px rgba(182,212,255,.75)); }
    .node-core{ fill:#b6d4ff; }
    .label{ font: 500 14px/1 sans-serif; fill:#dce6ff; paint-order: stroke; stroke:#000; stroke-width:3px; }
    .orbit{ stroke: rgba(255,255,255,.16); stroke-dasharray: 4 6; }

    /* Constellation animations */
    .edge { animation: pulse 6s ease-in-out infinite; }
    .ray  { animation: pulse 8s ease-in-out infinite; opacity:.28; }
    @keyframes pulse { 0%,100%{ opacity:.35 } 50%{ opacity:.75 } }

    /* Twinkle stars at nodes */
    .twinkle { filter:url(#glow); animation: twinkle 3.6s ease-in-out infinite; }
    .twinkle.slow{ animation-duration: 5.2s; }
    .twinkle.fast{ animation-duration: 2.8s; }
    @keyframes twinkle { 0%,100%{ opacity:.35 } 50%{ opacity:1 } }

    /* Parallax labels (JS updates transform) */
    text.label { transition: transform .12s linear; will-change: transform; }

    /* SCROLLER de cartes (snap) */
    .scroller{ overflow:auto; -webkit-overflow-scrolling: touch; scroll-snap-type:x mandatory; display:flex; gap:16px; padding: 0 1rem 1.2rem; }
    .cardx{ flex:0 0 84vw; max-width:520px; scroll-snap-align:center; background: rgba(0,0,0,.35); border:1px solid rgba(255,255,255,.08); border-radius:20px; backdrop-filter: blur(6px); }
    .cardx .cover{ position:relative; border-bottom:1px solid rgba(255,255,255,.08); }
    .cardx .cover img{ display:block; width:100%; height:auto; object-fit:cover; border-top-left-radius:20px; border-top-right-radius:20px; }
    .corner-badge{ position:absolute; top:10px; left:10px; padding:.32rem .6rem; border-radius:999px; font-size:.75rem; background:rgba(0,0,0,.55); border:1px solid rgba(255,255,255,.18); color:#eaf2ff; }
    .cardx .body{ padding:16px; }
    .cardx h3{ margin:0 0 6px; font-size:1.15rem; }
    .cardx p{ margin:0 0 10px; color:#cbd7fb; }
    .cardx .actions{ display:flex; gap:8px; }

    @media (min-width: 992px){
      .cardx{ flex-basis: 420px; }
    }

    a{text-decoration:none}
    .btn-ghost{ --bs-btn-border-color: rgba(255,255,255,.35); --bs-btn-color:#e9f1ff; --bs-btn-hover-bg: rgba(255,255,255,.08); }

    footer{ opacity:.7; font-size:.9rem; }
  </style>
</head>
<body>
  <canvas id="starfieldCanvas" aria-hidden="true"></canvas>

  <!-- Nav minimale -->
  <nav class="navbar navbar-expand-md navbar-dark navbar-custom sticky-top">
    <div class="container">
      <a class="navbar-brand fw-bold" href="index.html">Le Chat Noir</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMain" aria-controls="navbarsMain" aria-expanded="false" aria-label="Basculer la navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarsMain">
        <ul class="navbar-nav ms-auto mb-2 mb-md-0">
          <li class="nav-item"><a class="nav-link" href="about.html">À propos</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <main>
    <!-- HERO -->
    <section class="hero container">
      <h1 class="display-5">Le Chat Noir — <span class="text-light-emphasis">Constellation</span></h1>
      <div class="spectrum"></div>
      <p>Une page d’accueil alternative, comme une **carte cosmique** des projets. Explore en cliquant les **étoiles** : chaque nœud mène à une émission ou un site associé.</p>
    </section>

    <!-- CONSTELLATION INTERACTIVE (SVG) -->
    <section class="constellation-wrap">
      <svg class="constellation" viewBox="0 0 1000 562" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <filter id="glow" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur stdDeviation="2" result="coloredBlur"/>
            <feMerge>
              <feMergeNode in="coloredBlur"/>
              <feMergeNode in="SourceGraphic"/>
            </feMerge>
          </filter>
        </defs>
        <!-- Orbits / guides -->
        <circle cx="500" cy="281" r="260" class="orbit" fill="none"/>
        <circle cx="500" cy="281" r="180" class="orbit" fill="none"/>

        <!-- Edges (lines) — constellation fermée + rayons vers le hub -->
        <g class="edge" stroke="rgba(182,212,255,.65)" stroke-width="2">
          <line x1="430" y1="120" x2="220" y2="240"/>
          <line x1="220" y1="240" x2="300" y2="420"/>
          <line x1="300" y1="420" x2="740" y2="420"/>
          <line x1="740" y1="420" x2="770" y2="210"/>
          <line x1="770" y1="210" x2="430" y2="120"/>
        </g>
        <g class="ray" stroke="rgba(182,212,255,.75)" stroke-width="1.5">
          <line x1="500" y1="281" x2="430" y2="120"/>
          <line x1="500" y1="281" x2="220" y2="240"/>
          <line x1="500" y1="281" x2="300" y2="420"/>
          <line x1="500" y1="281" x2="740" y2="420"/>
          <line x1="500" y1="281" x2="770" y2="210"/>
        </g>

        <!-- Twinkle stars at intersections / nodes -->
        <g fill="#dce6ff">
          <circle class="twinkle fast" cx="430" cy="120" r="3"/>
          <circle class="twinkle" cx="220" cy="240" r="3"/>
          <circle class="twinkle slow" cx="300" cy="420" r="3"/>
          <circle class="twinkle" cx="740" cy="420" r="3"/>
          <circle class="twinkle fast" cx="770" cy="210" r="3"/>
          <circle class="twinkle slow" cx="500" cy="281" r="2"/>
        </g>

        <!-- Dynamic highlight path from hub to hovered/clicked node -->
        <line id="hub-highlight" x1="500" y1="281" x2="500" y2="281" stroke="rgba(255,215,97,.95)" stroke-width="3.5" opacity="0" filter="url(#glow)"/>

        <!-- Center hub -->
        <g transform="translate(500 281)">
          <a xlink:href="index.html" class="star-link">
            <circle r="18" class="node"></circle>
            <circle r="6" class="node-core"></circle>
            <text class="label" x="22" y="6" data-px="0.6">Le Chat Noir</text>
          </a>
        </g>

        <!-- Nodes -->
        <g>
          <a xlink:href="pseudocumentaire.html" class="star-link">
            <circle cx="220" cy="240" r="14" class="node"/>
            <circle cx="220" cy="240" r="5" class="node-core"/>
            <text class="label" x="240" y="244" data-px="1">Le Pseudodocumentaire</text>
          </a>
          <a xlink:href="lautrenuit.html" class="star-link">
            <circle cx="300" cy="420" r="14" class="node"/>
            <circle cx="300" cy="420" r="5" class="node-core"/>
            <text class="label" x="320" y="424" data-px="1">L’Autre Nuit</text>
          </a>
          <a xlink:href="ntsradiosupporter.html" class="star-link">
            <circle cx="740" cy="420" r="14" class="node"/>
            <circle cx="740" cy="420" r="5" class="node-core"/>
            <text class="label" x="760" y="424" data-px="1">NTS — Mixtapes</text>
          </a>
          <a xlink:href="hometaping.html" class="star-link">
            <circle cx="770" cy="210" r="14" class="node"/>
            <circle cx="770" cy="210" r="5" class="node-core"/>
            <text class="label" x="790" y="214" data-px="1">Home Taping</text>
          </a>
          <a xlink:href="https://whendaychokesthenight.wordpress.com/" target="_blank" rel="noopener" class="star-link">
            <circle cx="430" cy="120" r="14" class="node"/>
            <circle cx="430" cy="120" r="5" class="node-core"/>
            <text class="label" x="450" y="124" data-px="1">When Day Chokes The Night</text>
          </a>
        </g>
      </svg>
    </section>


    <footer class="container pb-5 text-center text-light-emphasis">
      Version expérimentale — indextest. <a href="index.html" class="link-light">Revenir à l’accueil classique</a>
    </footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
  // --- Canvas starfield + UFOs (Atari-like) ---
  (function(){
    const canvas = document.getElementById('starfieldCanvas');
    if(!canvas) return;
    const ctx = canvas.getContext('2d');
    let w,h,stars=[],ufos=[];
    function resize(){
      w = canvas.width  = window.innerWidth  * (window.devicePixelRatio||1);
      h = canvas.height = window.innerHeight * (window.devicePixelRatio||1);
      canvas.style.width='100%'; canvas.style.height='100%';
      const isMobile = window.innerWidth < 700;
      const starCount = isMobile ? 140 : 280;
      const ufoCount  = isMobile ? 2   : 5;
      stars = Array.from({length: starCount}, ()=>({ x:Math.random()*w, y:Math.random()*h, s:Math.random()*(isMobile?1.1:1.6)+0.6, a:Math.random(), d:Math.random()*0.02+0.005 }));
      ufos  = Array.from({length: ufoCount }, ()=>({ x:Math.random()*w, y:Math.random()*h*0.7, ang:Math.random()*Math.PI*2, spd:(Math.random()*0.35+0.12)*(window.devicePixelRatio||1), sc:(Math.random()*0.45+0.6)*(isMobile?0.85:1)}));
    }
    window.addEventListener('resize', resize); resize();
    function drawUFO(u){ ctx.save(); ctx.translate(u.x,u.y); ctx.scale(u.sc,u.sc); ctx.beginPath(); const pts=[[-9,0],[-3,-3],[-2,-6],[2,-6],[3,-3],[9,0],[-9,0],[-3,4],[3,4],[9,0]]; ctx.moveTo(pts[0][0],pts[0][1]); for(let i=1;i<pts.length;i++){ ctx.lineTo(pts[i][0],pts[i][1]); } ctx.closePath(); ctx.fillStyle='#9ecbff'; ctx.fill(); ctx.strokeStyle='rgba(255,255,255,.9)'; ctx.lineWidth=1.2; ctx.stroke(); ctx.restore(); }
    function loop(){ ctx.clearRect(0,0,w,h); for(const s of stars){ s.a += s.d*(Math.random()<0.5?1:-1); if(s.a<0){ s.x=Math.random()*w; s.y=Math.random()*h; s.a=0;} if(s.a>1) s.a=1; ctx.globalAlpha=s.a; ctx.fillStyle='#fff'; const sz = s.s*(window.devicePixelRatio||1); ctx.fillRect(s.x,s.y,sz,sz);} ctx.globalAlpha=1; for(const u of ufos){ u.ang += (Math.random()*0.08 - 0.04); u.x += Math.cos(u.ang)*u.spd; u.y += Math.sin(u.ang)*u.spd*0.6; if(u.x<-60)u.x=w+60; if(u.x>w+60)u.x=-60; if(u.y<-40)u.y=h+40; if(u.y>h+40)u.y=-40; drawUFO(u);} requestAnimationFrame(loop);} loop(); })();
  </script>
  <script>
  // --- Micro‑parallax for labels ---
  (function(){
    const svg = document.querySelector('svg.constellation');
    if(!svg) return;
    const labels = Array.from(svg.querySelectorAll('text.label'));
    function onMove(e){
      const vw = window.innerWidth, vh = window.innerHeight;
      const cx = vw/2, cy = vh/2;
      const px = (('touches' in e)? e.touches[0].clientX : e.clientX) || cx;
      const py = (('touches' in e)? e.touches[0].clientY : e.clientY) || cy;
      const dx = (px - cx) / vw; // -0.5..0.5
      const dy = (py - cy) / vh; // -0.5..0.5
      labels.forEach(t=>{
        const amp = parseFloat(t.getAttribute('data-px')||'1');
        const tx = dx * 14 * amp; // max ~14px
        const ty = dy * 10 * amp; // max ~10px
        t.setAttribute('transform', `translate(${tx},${ty})`);
      });
    }
    window.addEventListener('mousemove', onMove, {passive:true});
    window.addEventListener('touchmove', onMove, {passive:true});
  })();
  </script>
  <script>
  // --- Highlight hub→node on hover/click + tiny beep ---
  (function(){
    const svg = document.querySelector('svg.constellation');
    if(!svg) return;
    const hub = { x:500, y:281 };
    const hi = svg.querySelector('#hub-highlight');
    const links = Array.from(svg.querySelectorAll('g > a.star-link'));

    // WebAudio beep (very short, soft)
    let audioCtx = null;
    function beep(freq=880, dur=0.07, vol=0.03){
      try{
        audioCtx = audioCtx || new (window.AudioContext||window.webkitAudioContext)();
        const o = audioCtx.createOscillator();
        const g = audioCtx.createGain();
        o.type = 'sine'; o.frequency.value = freq;
        g.gain.value = vol;
        o.connect(g); g.connect(audioCtx.destination);
        o.start(); setTimeout(()=>{ o.stop(); }, Math.max(10, dur*1000));
      }catch(e){ /* ignore */ }
    }

    function showHighlight(to){
      hi.setAttribute('x1', hub.x); hi.setAttribute('y1', hub.y);
      hi.setAttribute('x2', to.x);  hi.setAttribute('y2', to.y);
      hi.setAttribute('opacity', '1');
    }
    function hideHighlight(){ hi.setAttribute('opacity','0'); }

    links.forEach(a=>{
      // Skip the center hub link (it’s inside a translated <g>, not in this list)
      const nodeCircle = a.querySelector('circle.node');
      const cx = nodeCircle.getAttribute('cx');
      const cy = nodeCircle.getAttribute('cy');
      // Some nodes (hub children) might be in translated coords; only attach if cx/cy exist
      if(cx!==null && cy!==null){
        const target = { x: parseFloat(cx), y: parseFloat(cy) };
        a.addEventListener('mouseenter', ()=>{ showHighlight(target); beep(1320, 0.05, 0.02); });
        a.addEventListener('mouseleave', ()=>{ hideHighlight(); });
        a.addEventListener('click', ()=>{ showHighlight(target); beep(990, 0.08, 0.035); setTimeout(hideHighlight, 800); });
        a.addEventListener('touchstart', ()=>{ showHighlight(target); beep(990, 0.08, 0.035); setTimeout(hideHighlight, 900); }, {passive:true});
      }
    });
  })();
  </script>
</body>
</html>